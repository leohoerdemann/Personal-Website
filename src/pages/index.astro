---
import DesktopLayout from "../layouts/DesktopLayout.astro";

// Server-side user-agent detection
const userAgent = Astro.request.headers.get('user-agent') || '';
const hasJsEnabled = Astro.request.headers.get('sec-ch-ua') !== null;
const isMobile = /mobile/i.test(userAgent);
---
<head>
  <!-- Google tag (gtag.js) -->
  <script is:inline async src="https://www.googletagmanager.com/gtag/js?id=G-L158HM7H96"></script>
  <script is:inline>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-L158HM7H96');
  </script>
</head>

{isMobile || !hasJsEnabled ? (
    // Redirect to Linktree for mobile devices with JavaScript enabled
    <script is:inline>
      console.log('Redirecting to Linktree');
      window.location.href = "linktree";
    </script>
) : (
    // Render DesktopLayout for desktop devices
    <DesktopLayout />
)}
